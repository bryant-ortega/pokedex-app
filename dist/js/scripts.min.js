let pokemonRepository=(function(){let pokemonList=[];let apiUrl="https://pokeapi.co/api/v2/pokemon/?limit=950";let searchButton=$(".btn-warning");searchButton.on("click",function(){let pokemonList=$(".pokemon-list");pokemonList.empty();search($(".form-control").val()).forEach(function(pokemon){addListItem(pokemon)})});let searchBar=$(".form-control");searchBar.on("keypress keyup",event=>{let pokemonList=$(".pokemon-list");pokemonList.empty();if(event.keyCode===8||event.keyCode===46){search($(".form-control").val()).forEach(pokemon=>addListItem(pokemon))}else{search($(".form-control").val()).forEach(pokemon=>addListItem(pokemon))}});function getAll(){return pokemonList}
function add(pokemon){if(typeof pokemon==="object"){pokemonList.push(pokemon)}else{console.log("Incorrect Pokemon Data! Please enter name, height, and type(s).")}}
function search(query){return pokemonList.filter(pokemon=>pokemon.name.toLowerCase().includes(query.toLowerCase()))}
function addListItem(pokemon){let pokemonList=$(".pokemon-list");let listItem=$('<li class="group-list-item"></li>');let button=$(`<button type="button" class="pokemon-button btn btn-primary" 
            data-toggle="modal" data-target="#pokeModal">${pokemon.name}</button>`);listItem.append(button);pokemonList.append(listItem);button.on("click",function(){showDetails(pokemon)})}
function showModal(item){let modalBody=$(".modal-body");let modalTitle=$(".modal-title");let modalHeader=$(".modal-header");let types="";item.types.forEach(type=>{type+=type.type.name+" "});modalTitle.empty();modalBody.empty();let nameElement=$("<h1>"+item.name+"</h1>");let imageElement=$('<img class="modal-img" style="width:20%">');imageElement.attr("src",item.imageUrl);let heightElement=$("<p>"+"Height : "+(item.height/10)+"m"+"</p>");let typeElement=$("<p>"+"Type: "+item.types.map(type=>type.type.name).join(", ")+"</p>");modalTitle.append(nameElement);modalBody.append(imageElement);modalBody.append(heightElement);modalBody.append(typeElement)}
function showDetails(pokemon){loadDetails(pokemon).then(function(){showModal(pokemon)})}
function loadList(){return fetch(apiUrl).then(function(response){return response.json()}).then(function(json){json.results.forEach(function(item){let pokemon={name:item.name,detailsUrl:item.url,};add(pokemon)})}).catch(function(e){console.error(e)})}
function loadDetails(item){let url=item.detailsUrl;return fetch(url).then(function(response){return response.json()}).then(function(details){item.imageUrl=details.sprites.other.dream_world.front_default;item.height=details.height;item.types=details.types}).catch(function(e){console.error(e)})}
return{getAll:getAll,add:add,search:search,addListItem:addListItem,loadList:loadList,loadDetails:loadDetails,}})();pokemonRepository.loadList().then(function(){pokemonRepository.getAll().forEach(function(pokemon){pokemonRepository.addListItem(pokemon)})})